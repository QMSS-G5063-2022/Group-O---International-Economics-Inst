runApp('Spring_22/5063_Dataviz/Group-O---International-Economics-Inst/Delete_later.R')
runApp('Spring_22/5063_Dataviz/Group-O---International-Economics-Inst/Delete_later.R')
runApp('Spring_22/5063_Dataviz/Group-O---International-Economics-Inst/Delete_later.R')
runApp('Spring_22/5063_Dataviz/Group-O---International-Economics-Inst/Delete_later.R')
runApp('Delete_later.R')
runApp('Spring_22/5063_Dataviz/Group-O---International-Economics-Inst/Delete_later.R')
runApp('Spring_22/5063_Dataviz/Group-O---International-Economics-Inst/Maps with Shiny.R')
runApp('Spring_22/5063_Dataviz/Group-O---International-Economics-Inst/Delete_later.R')
runApp('Spring_22/5063_Dataviz/Group-O---International-Economics-Inst/Delete_later.R')
runApp('Spring_22/5063_Dataviz/Group-O---International-Economics-Inst/Delete_later.R')
runApp('Spring_22/5063_Dataviz/Group-O---International-Economics-Inst/Delete_later.R')
runApp('Spring_22/5063_Dataviz/Group-O---International-Economics-Inst/Delete_later.R')
runApp('Spring_22/5063_Dataviz/Group-O---International-Economics-Inst/Delete_later.R')
runApp('Spring_22/5063_Dataviz/Group-O---International-Economics-Inst/Delete_later.R')
runApp('Spring_22/5063_Dataviz/Group-O---International-Economics-Inst/Delete_later.R')
suppressPackageStartupMessages(library(shiny))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(rgdal))
suppressPackageStartupMessages(library(WDI))
library(leaflet)
library(WDI)
WDIsearch("right")
WDIsearch("rights")
WDIsearch("gini")
library(vdemdata)
f<-vdem
head(f)
View(f)
View(filter(f, year>=2005))
WDIsearch("Gini")
gini<-WDI("3.0.Gini", start=2005, extra=F)
gini<-WDI("all", "3.0.Gini", 2005, extra=F)
unique(gini$country)[50]
unique(gini$country)
WDIsearch("Gini")
gini<-WDI(country="all",indicator="3.0.Gini", start=2005, extra=F)
gini<-WDI(country="all",indicator="3.0.Gini_nonzero", start=2005, extra=F)
WDIsearch("Gini")
gini<-WDI(country="all",indicator="3.0.Gini_nozero", start=2005, extra=F)
imf<-WDI(indicator = "DT.DOD.DIMF.CD", country="all",start=2005, extra=F)
WDIsearch("GDP growth")
gini<-WDI(country="all",indicator="5.51.01.10.gdp", start=2005, extra=F)
rm(gini)
gdp<-WDI(country="all",indicator="5.51.01.10.gdp", start=2005, extra=F)
View(gdp)
length(unique(gdp$country))
unique(gdp$country)[50]
unique(gdp$country)[30]
unique(gdp$country)[15]
unique(gdp$country)[5]
unique(gdp$country)[10]
unique(gdp$country)[9]
gdp<-filter(gdp, !coutry %in% unique(gdp$country)[1:9])
gdp<-filter(gdp, !country %in% unique(gdp$country)[1:9])
worldmap = readOGR(dsn="Nat_world_map", layer="ne_50m_admin_0_countries")
getwd()
path<-"Spring_22/5063_Dataviz/"
path<-paste0(path,"Group-O---International-Economics-Inst")
path
world<-readOGR(dsn=paste0(path,"/Nat_world_map", layer="ne_50m_admin_0_countries"))
path
world<-readOGR(dsn=paste0(path,"/Nat_world_map"), layer="ne_50m_admin_0_countries")
setdiff(gdp$country, world@data$NAME_EN)
unique(world@data$NAME_EN)[grep("Ivo"), unique(world@data$NAME_EN)]
unique(world@data$NAME_EN)[grep("Ivo", unique(world@data$NAME_EN))]
unique(world@data$NAME_EN)[grep("Congo", unique(world@data$NAME_EN))]
head(imf)
setdiff(gdp$country, imf$country)
setdiff(gdp$country, world@data$NAME_EN)
unique(world@data$NAME_EN)[grep("erde", unique(world@data$NAME_EN))]
unique(world@data$NAME_EN)[grep("Micro", unique(world@data$NAME_EN))]
unique(world@data$NAME_EN)[grep("Gambia", unique(world@data$NAME_EN))]
unique(world@data$NAME_EN)[grep("Kyr", unique(world@data$NAME_EN))]
unique(world@data$NAME_EN)[grep("Kitts", unique(world@data$NAME_EN))]
unique(world@data$NAME_EN)[grep("ucia", unique(world@data$NAME_EN))]
unique(world@data$NAME_EN)[grep("rinc", unique(world@data$NAME_EN))]
unique(world@data$NAME_EN)[grep("Sao", unique(world@data$NAME_EN))]
unique(world@data$NAME_EN)[grep("Tom", unique(world@data$NAME_EN))]
unique(world@data$NAME_EN)[grep("Tim", unique(world@data$NAME_EN))]
unique(world@data$NAME_EN)[grep("Vinc", unique(world@data$NAME_EN))]
View(gdp)
View(gdp)
library(vdemdata)
f<-vdem()
View(f)
dem<-vdem[c("country_name","country_text_id","year","v2x_libdem")]
dem<-filter(vdem[c("country_name","country_text_id","year","v2x_libdem")],year>2004)
setdiff(dem$country_name, world@data$NAME)
View(world@data)
setdiff(dem$country_text_id, world@data$SOV_A3)
setdiff(dem$country_text_id, world@data$ADM0_A3)
setdiff(dem$country_text_id, world@data$ADM0_A3_US)
View(filter(dem, country_text_id %in% setdiff(dem$country_text_id, world@data$ADM0_A3_US)))
unique(world@data$NAME)[grep("Kos",unique(world@data$NAME))]
world@data[world@data$NAME=="Kosovo", c("NAME", "ADM0_A3")]
unique(world@data$NAME)[grep("Sudan",unique(world@data$NAME))]
world@data[world@data$NAME=="S. Suda", c("NAME", "ADM0_A3")]
world@data[world@data$NAME=="S. Sudan", c("NAME", "ADM0_A3")]
unique(world@data$NAME)[grep("Pales",unique(world@data$NAME))]
world@data[world@data$NAME=="Palestine", c("NAME", "ADM0_A3")]
unique(world@data$NAME)[grep("Gaza",unique(world@data$NAME))]
unique(world@data$NAME)[grep("West B",unique(world@data$NAME))]
unique(world@data$NAME)[grep("Somal",unique(world@data$NAME))]
world@data[world@data$NAME=="Somaliland", c("NAME", "ADM0_A3")]
world@data[world@data$NAME=="Zanzibar", c("NAME", "ADM0_A3")]
unique(world@data$NAME)[grep("Zan",unique(world@data$NAME))]
View(dem)
runApp('Spring_22/5063_Dataviz/Group-O---International-Economics-Inst/Mappy_Appy2.R')
View(gdp)
runApp('Spring_22/5063_Dataviz/Group-O---International-Economics-Inst/Mappy_Appy2.R')
runApp('Spring_22/5063_Dataviz/Group-O---International-Economics-Inst/Mappy_Appy2.R')
worldmap = readOGR(dsn="Nat_world_map", layer="ne_50m_admin_0_countries")
path
worldmap<-readOGR(dsn=paste0(path, "/Nat_world_map"), layer="ne_50m_admin_0_countries")
worldmap@data[worldmap@data$NAME=="United States of America",]$NAME<-"United States"
worldmap@data[worldmap@data$NAME=="Congo",]$NAME<-"Rep. of Congo"
worldmap@data[worldmap@data$NAME=="South Korea",]$NAME<-"Korea"
worldmap@data[worldmap@data$NAME=="North Korea",]$NAME<-"Dem. Rep. Korea"
worldmap@data[worldmap@data$NAME=="Czechia",]$NAME<-"Czech Rep."
worldmap@data[worldmap@data$NAME==unique(worldmap@data$NAME)[grep("Ivoi",unique(worldmap@data$NAME))],]$NAME<-"Cote d'Ivoire"
worldmap@data[worldmap@data$NAME=="Cabo Verde",]$NAME<-"Cape Verde"
worldmap@data[worldmap@data$NAME=="Trinidad and Tobago",]$NAME<-"Trinidad & Tobago"
worldmap@data[worldmap@data$NAME=="Eq. Guinea",]$NAME<-"Equatorial Guinea"
worldmap@data[worldmap@data$NAME=="Bosnia and Herz.",]$NAME<-"Bosnia"
worldmap@data[worldmap@data$NAME=="Antigua and Barb.",]$NAME<-"Antigua and Barbuda"
worldmap@data[worldmap@data$NAME=="Solomon Is.",]$NAME<-"Solomon Islands"
worldmap@data[worldmap@data$NAME==unique(worldmap@data$NAME)[grep("Tom",unique(worldmap@data$NAME))],]$NAME<-"Sao Tome"
worldmap@data[worldmap@data$NAME_EN=="People's Republic of China",]$NAME_EN<-"China"
worldmap@data[worldmap@data$NAME_EN=="Ivory Coast",]$NAME_EN<-"Cote d'Ivoire"
worldmap@data[worldmap@data$NAME_EN=="Democratic Republic of the Congo",]$NAME_EN<-"Congo, Dem. Rep."
worldmap@data[worldmap@data$NAME_EN=="Republic of the Congo",]$NAME_EN<-"Congo, Rep."
worldmap@data[worldmap@data$NAME_EN=="Cape Verde",]$NAME_EN<-"Cabo Verde"
worldmap@data[worldmap@data$NAME_EN=="Egypt",]$NAME_EN<-"Egypt, Arab Rep."
worldmap@data[worldmap@data$NAME_EN=="Iran",]$NAME_EN<-"Iran, Islamic Rep."
worldmap@data[worldmap@data$NAME_EN=="Federated States of Micronesia",]$NAME_EN<-"Micronesia, Fed. Sts."
worldmap@data[worldmap@data$NAME_EN=="The Gambia",]$NAME_EN<-"Gambia, The"
worldmap@data[worldmap@data$NAME_EN=="Kyrgyzstan",]$NAME_EN<-"Kyrgyz Republic"
worldmap@data[worldmap@data$NAME_EN=="Saint Kitts and Nevis",]$NAME_EN<-"St. Kitts and Nevis"
worldmap@data[worldmap@data$NAME_EN=="Laos",]$NAME_EN<-"Lao PDR."
worldmap@data[worldmap@data$NAME_EN=="Russia",]$NAME_EN<-"Russian Federation"
worldmap@data[worldmap@data$NAME_EN=="Venezuela",]$NAME_EN<-"Venezuela, RB"
worldmap@data[worldmap@data$NAME_EN=="Yemen",]$NAME_EN<-"Yemen, Rep."
worldmap@data[worldmap@data$NAME_EN=="Saint Lucia",]$NAME_EN<-"St. Lucia"
worldmap@data[worldmap@data$NAME_EN==unique(world@data$NAME_EN)[grep("Tom", unique(world@data$NAME_EN))],]$NAME_EN<-"Sao Tome and Principe"
worldmap@data[worldmap@data$NAME_EN=="East Timor",]$NAME_EN<-"Timor-Leste"
worldmap@data[worldmap@data$NAME_EN=="Syria",]$NAME_EN<-"Syrian Arab Republic"
worldmap@data[worldmap@data$NAME_EN=="Saint Vincent and the Grenadines",]$NAME_EN<-"St. Vincent and the Grenadines"
chn_inv<-read.csv(paste0(path, "/China-Global-Investment-Tracker-2021-Fall-FINAL-2022.2.21-update.up.csv"))
chn_inv<-chn_inv %>%
group_by(Year, Country) %>%
mutate(inv_tot = sum(as.numeric(gsub("[[:punct:]]", "", Quantity.in.Millions))))
chn_inv$Country<-stringr::str_to_lower(chn_inv$Country)
chn_inv[chn_inv$Country=="britain",]$Country<-"uk"
chn_inv[chn_inv$Country=="myanmar",]$Country<-"burma"
chn_inv[chn_inv$Country=="russian federation",]$Country<-"russia"
chn_inv[chn_inv$Country=="trinidad-tobago",]$Country<-"trinidad and tobago"
chn_inv[chn_inv$Country=="bosnia",]$Country<-"bosnia and herzegovina"
chn_inv[chn_inv$Country=="sao tome",]$Country<-"uk"
inv_y<-filter(chn_inv, Year==input$year)
inv_y<-inv_y[!duplicated(inv_y$Country),c("Country","inv_tot")]
inv_y$inv_tot<-as.numeric(inv_y$inv_tot)
inv_y<-filter(chn_inv, Year==2015)
inv_y<-inv_y[!duplicated(inv_y$Country),c("Country","inv_tot")]
inv_y$inv_tot<-as.numeric(inv_y$inv_tot)
worldmap@data$sov_low<-stringr::str_to_lower(worldmap@data$SOVEREIGNT)
worldmap@data[worldmap@data$sov_low=="the bahamas",]$sov_low<-"bahamas"
worldmap@data[worldmap@data$sov_low=="united kingdom",]$sov_low<-"uk"
worldmap@data[worldmap@data$sov_low=="united states of america",]$sov_low<-"usa"
worldmap@data[worldmap@data$sov_low=="united arab emirates",]$sov_low<-"uae"
worldmap@data[worldmap@data$sov_low=="czechia",]$sov_low<-"czech republic"
worldmap@data[worldmap@data$sov_low=="east timor",]$sov_low<-"timor-leste"
worldmap@data[worldmap@data$sov_low=="united republic of tanzania",]$sov_low<-"tanzania"
worldmap@data<-left_join(worldmap@data, inv_y, by=c("sov_low"="Country"))
gdp<-WDI(country="all",indicator="5.51.01.10.gdp", start=2005, extra=F)
gdp<-filter(gdp, !country %in% unique(gdp$country)[1:9])
gdp<-rename(gdp, Year=year, name=country, gdp_growth=`5.51.01.10.gdp`)
gdp_y<-filter(gdp, Year==input$year)
worldmap@data<-left_join(worldmap@data, gdp_y, by=c("NAME_EN"="name"))
gdp_y<-filter(gdp, Year==2015)
worldmap@data<-left_join(worldmap@data, gdp_y, by=c("NAME_EN"="name"))
View(worldmap@data)
imf<-WDI(indicator = "DT.DOD.DIMF.CD", country="all",start=2005, extra=F)
imf<-filter(imf, !country %in% unique(imf$country)[1:49])
imf<-rename(imf, Year=year, name=country, IMF_cred=DT.DOD.DIMF.CD)
imf[imf$name=="Bahamas, The",]$name<-"The Bahamas"
#imf[imf$name=="Cabo Verde",]$name<-"Cape Verde"
#imf[imf$name=="China",]$name<-"People's Republic of China"
#imf[imf$name=="Congo, Rep.",]$name<-"Republic of the Congo"
#imf[imf$name=="Congo, Dem. Rep.",]$name<-"Democratic Republic of the Congo"
#imf[imf$name=="Cote d'Ivoire",]$name<-"Ivory Coast"
#imf[imf$name=="Egypt, Arab Rep.",]$name<-"Egypt"
#imf[imf$name=="Gambia, The",]$name<-"Gambia"
imf[imf$name=="Hong Kong SAR, China",]$name<-"Hong Kong"
#imf[imf$name=="Iran, Islamic Rep.",]$name<-"Iran"
imf[imf$name=="Korea, Rep.",]$name<-"South Korea"
imf[imf$name=="Korea, Dem. People's Rep.",]$name<-"North Korea"
#imf[imf$name=="Kyrgyz Republic",]$name<-"Kyrgyzstan"
#imf[imf$name=="Lao PDR",]$name<-"Laos"
#imf[imf$name=="Russian Federation",]$name<-"Russia"
#imf[imf$name=="Micronesia, Fed. Sts.",]$name<-"Micronesia"
#imf[imf$name=="Syrian Arab Republic",]$name<-"Syria"
imf[imf$name=="Slovak Republic",]$name<-"Slovakia"
imf[imf$name=="Sint Maarten (Dutch part)",]$name<-"Sint Maarten"
imf[imf$name=="St. Martin (French part)",]$name<-"Saint Martin"
#imf[imf$name=="St. Kitts and Nevis",]$name<-"Saint Kitts and Nevis"
#imf[imf$name=="St. Lucia",]$name<-"Saint Lucia"
#imf[imf$name=="St. Vincent and the Grena
imf[imf$name=="United States",]$name<-"USA"
#imf[imf$name=="Venezuela, RB",]$name<-"Venezuela"
imf[imf$name=="Virgin Islands (U.S.)",]$name<-"United States Virgin Islands"
#imf[imf$name=="Yemen, Rep.",]$name<-"Yemen"
inv_y<-filter(imf, Year==2015)[c("name","IMF_cred")]
worldmap@data[worldmap@data$NAME_EN=="Brunei",]$NAME_EN<-"Brunei Darussalam"
#worldmap@data[worldmap@data$NAME_EN=="People's Republic of China",]$NAME_EN<-"China"
#worldmap@data[worldmap@data$NAME_EN=="The Gambia",]$NAME_EN<-"Gambia"
#worldmap@data[worldmap@data$NAME_EN=="Federated States of Micronesia",]$NAME_EN<-"Micronesia"
worldmap@data[worldmap@data$NAME_EN=="United States of America",]$NAME_EN<-"USA"
worldmap@data[worldmap@data$NAME_EN==unique(worldmap@data$NAME_EN)[grep("Cura",worldmap@data$NAME_EN)],]$NAME_EN<-"Curacao"
worldmap@data<-left_join(worldmap@data, inv_y, by=c("NAME_EN"="name"))
View(worldmap@data)
runApp('Spring_22/5063_Dataviz/Group-O---International-Economics-Inst/Mappy_Appy2.R')
runApp('Spring_22/5063_Dataviz/Group-O---International-Economics-Inst/Mappy_Appy2.R')
grep("US", gdp$name)
grep("United St", gdp$name)
grep("America", gdp$name)
WDIsearch("GDP growth")
View(WDI("all","6.0.GDP_growth",2005))
View(WDI("all","NY.GDP.MKTP.KD.ZG",start=2005))
View(WDI("all","NY.GDP.MKTP.KN.87.ZG",start=2005))
WDIsearch("GDP growth")
View(WDI("all","NY.GDP.MKTP.KN.87.ZG",start=2005))
gdp<-WDI(country="all",indicator="NY.GDP.MKTP.KD.ZG", start=2005, extra=F)
unique(gdp$country)[50]
setdiff(gdp$country, worldmap@data$NAME_EN)
gdp<-filter(gdp, !country %in% unique(gdp$country)[1:49])
setdiff(gdp$country, worldmap@data$NAME_EN)
unique(worldmap@data$NAME_EN)[grep("Bahamas", unique(worldmap@data$NAME_EN))]
unique(worldmap@data$NAME_EN)[grep("Hong", unique(worldmap@data$NAME_EN))]
unique(worldmap@data$NAME_EN)[grep("Korea", unique(worldmap@data$NAME_EN))]
unique(worldmap@data$NAME_EN)[grep("Lao", unique(worldmap@data$NAME_EN))]
unique(worldmap@data$NAME_EN)[grep("Macao", unique(worldmap@data$NAME_EN))]
unique(worldmap@data$NAME_EN)[grep("United", unique(worldmap@data$NAME_EN))]
unique(worldmap@data$NAME_EN)[grep("US", unique(worldmap@data$NAME_EN))]
unique(worldmap@data$NAME_EN)[grep("art", unique(worldmap@data$NAME_EN))]
unique(worldmap@data$NAME_EN)[grep("lovak", unique(worldmap@data$NAME_EN))]
unique(worldmap@data$NAME_EN)[grep("irgin", unique(worldmap@data$NAME_EN))]
runApp('Spring_22/5063_Dataviz/Group-O---International-Economics-Inst/Mappy_Appy2.R')
setwd(paste0(path,"/"))
worldmap = readOGR(dsn="Nat_world_map", layer="ne_50m_admin_0_countries")
worldmap@data[worldmap@data$NAME=="United States of America",]$NAME<-"United States"
worldmap@data[worldmap@data$NAME=="Congo",]$NAME<-"Rep. of Congo"
worldmap@data[worldmap@data$NAME=="South Korea",]$NAME<-"Korea"
worldmap@data[worldmap@data$NAME=="North Korea",]$NAME<-"Dem. Rep. Korea"
worldmap@data[worldmap@data$NAME=="Czechia",]$NAME<-"Czech Rep."
worldmap@data[worldmap@data$NAME==unique(worldmap@data$NAME)[grep("Ivoi",unique(worldmap@data$NAME))],]$NAME<-"Cote d'Ivoire"
worldmap@data[worldmap@data$NAME=="Cabo Verde",]$NAME<-"Cape Verde"
worldmap@data[worldmap@data$NAME=="Trinidad and Tobago",]$NAME<-"Trinidad & Tobago"
worldmap@data[worldmap@data$NAME=="Eq. Guinea",]$NAME<-"Equatorial Guinea"
worldmap@data[worldmap@data$NAME=="Bosnia and Herz.",]$NAME<-"Bosnia"
worldmap@data[worldmap@data$NAME=="Antigua and Barb.",]$NAME<-"Antigua and Barbuda"
worldmap@data[worldmap@data$NAME=="Solomon Is.",]$NAME<-"Solomon Islands"
worldmap@data[worldmap@data$NAME==unique(worldmap@data$NAME)[grep("Tom",unique(worldmap@data$NAME))],]$NAME<-"Sao Tome"
worldmap@data[worldmap@data$NAME_EN=="People's Republic of China",]$NAME_EN<-"China"
worldmap@data[worldmap@data$NAME_EN=="Ivory Coast",]$NAME_EN<-"Cote d'Ivoire"
worldmap@data[worldmap@data$NAME_EN=="Democratic Republic of the Congo",]$NAME_EN<-"Congo, Dem. Rep."
worldmap@data[worldmap@data$NAME_EN=="Republic of the Congo",]$NAME_EN<-"Congo, Rep."
worldmap@data[worldmap@data$NAME_EN=="Cape Verde",]$NAME_EN<-"Cabo Verde"
worldmap@data[worldmap@data$NAME_EN=="Egypt",]$NAME_EN<-"Egypt, Arab Rep."
worldmap@data[worldmap@data$NAME_EN=="Iran",]$NAME_EN<-"Iran, Islamic Rep."
worldmap@data[worldmap@data$NAME_EN=="Federated States of Micronesia",]$NAME_EN<-"Micronesia, Fed. Sts."
worldmap@data[worldmap@data$NAME_EN=="The Gambia",]$NAME_EN<-"Gambia, The"
worldmap@data[worldmap@data$NAME_EN=="Kyrgyzstan",]$NAME_EN<-"Kyrgyz Republic"
worldmap@data[worldmap@data$NAME_EN=="Saint Kitts and Nevis",]$NAME_EN<-"St. Kitts and Nevis"
worldmap@data[worldmap@data$NAME_EN=="Laos",]$NAME_EN<-"Lao PDR"
worldmap@data[worldmap@data$NAME_EN=="Russia",]$NAME_EN<-"Russian Federation"
worldmap@data[worldmap@data$NAME_EN=="Venezuela",]$NAME_EN<-"Venezuela, RB"
worldmap@data[worldmap@data$NAME_EN=="Yemen",]$NAME_EN<-"Yemen, Rep."
"USA"%in%worldmap@data$NAME_EN
unique(worldmap@data$NAME_EN)[grep("United", unique(worldmap@data$NAME_EN))]
"United States" %in% imf$name
"United States" %in% gdp$name
gdp<-WDI(country="all",indicator="NY.GDP.MKTP.KD.ZG", start=2005, extra=F)
unique(gdp$country)[grep("United", unique(gdp$country))]
"United States" %in% gdp$country
runApp('Mappy_Appy2.R')
runApp('Mappy_Appy2.R')
summary(gdp$NY.GDP.MKTP.KD.ZG)
View(filter(gdp, NY.GDP.MKTP.KD.ZG<-10 | NY.GDP.MKTP.KD.ZG>10))
View(filter(gdp, (NY.GDP.MKTP.KD.ZG<-10) | (NY.GDP.MKTP.KD.ZG>10)))
typeof(gdp$NY.GDP.MKTP.KD.ZG)
typeof(gdp$NY.GDP.MKTP.KD.ZG[1])
2*gdp$NY.GDP.MKTP.KD.ZG[1]
View(filter(gdp, (NY.GDP.MKTP.KD.ZG<-10))
)
View(filter(gdp, -10>NY.GDP.MKTP.KD.ZG | NY.GDP.MKTP.KD.ZG>10))
gdp$log<-log(gdp$NY.GDP.MKTP.KD.ZG)
View(filter(gdp, -10>NY.GDP.MKTP.KD.ZG | NY.GDP.MKTP.KD.ZG>10))
log(-1)
gdp$log<-log(abs(gdp$NY.GDP.MKTP.KD.ZG))
View(filter(gdp, -10>NY.GDP.MKTP.KD.ZG | NY.GDP.MKTP.KD.ZG>10))
for(i in 1:nrow(gdp)){
}
rm(i)
gdp$log2<-rep(0,nrow(gdp))
View(filter(gdp, -10>NY.GDP.MKTP.KD.ZG | NY.GDP.MKTP.KD.ZG>10))
gdp[gdp$log>0,]$log2<-gdp$log
gdp[gdp$log>0,]$log2<-gdp[gdp$log>0,]$log
for(i in 1:nrow(gdp)){
if(gdp$log[i]>0){gdp$log2[i]<-gdp$log[i]} else if(gdp$log[i]<0){gdp$log2[i]<-(0-gdp$log[i])}
}
gdp<-WDI(country="all",indicator="NY.GDP.MKTP.KD.ZG", start=2005, extra=F)
gdp$NY.GDP.MKTP.KD.ZG<-round(gdp$NY.GDP.MKTP.KD.ZG,2)
gdp<-filter(gdp, !country %in% unique(gdp$country)[1:49])
gdp<-rename(gdp, Year=year, name=country, gdp_growth=`NY.GDP.MKTP.KD.ZG`)
gdp$log<-log(gdp$gdp_growth)
gdp<-WDI(country="all",indicator="NY.GDP.MKTP.KD.ZG", start=2005, extra=F)
gdp$NY.GDP.MKTP.KD.ZG<-round(gdp$NY.GDP.MKTP.KD.ZG,2)
gdp<-filter(gdp, !country %in% unique(gdp$country)[1:49])
gdp<-rename(gdp, Year=year, name=country, gdp_growth=`NY.GDP.MKTP.KD.ZG`)
gdp$log<-log(abs(gdp$gdp_growth))
gdp$log[1]>0
for(i in 1:nrow(gdp)){
if(gdp$log[i]>=0){
gdp$log2[i]<-gdp$log[i]
}else{
gdp$log2[i]<-(0-gdp$log[i])
}
}
gdp$log[i]>=0
gdp$log[i]>0
View(gdp)
for(i in 1:nrow(gdp)){
if(gdp$gdp_growth[i]>=0){
gdp$log2[i]<-gdp$log[i]
}else{
gdp$log2[i]<-(0-gdp$log[i])
}
}
sum(is.na(gdp$gdp_growth))
for(i in 1:nrow(gdp)){
if(!is.na(gdp$gdp_growth[i]) & gdp$gdp_growth[i]>=0){
gdp$log2[i]<-gdp$log[i]
}else if(!is.na(gdp$gdp_growth[i])&gdp$gdp_growth[i]<0){
gdp$log2[i]<-(0-gdp$log[i])
}else if(is.na(gdp$gdp_growth[i])){
gdp$log2<-NA
}
}
!is.na(gdp$gdp_growth[1]) & gdp$gdp_growth[1]>=0
!is.na(gdp$gdp_growth[1])&gdp$gdp_growth[1]<0
for(i in 1:nrow(gdp)){
if(!is.na(gdp$gdp_growth[i]) & gdp$gdp_growth[i]>=0){
gdp$log2[i]<-gdp$log[i]
}else if(!is.na(gdp$gdp_growth[i])&gdp$gdp_growth[i]<0){
gdp$log2[i]<-(0-gdp$log[i])
}else if(is.na(gdp$gdp_growth[i])){
gdp$log2<-NA
}
}
for(i in 1:nrow(gdp)){
if(!is.na(gdp$gdp_growth[i]) & gdp$gdp_growth[i]>=0){
gdp$log2[i]<-gdp$log[i]
}}
for(i in 1:nrow(gdp)){
if(!is.na(gdp$gdp_growth[i]) & gdp$gdp_growth[i]>=0){
gdp$log2[i]<-gdp$log[i]
}else if(!is.na(gdp$gdp_growth[i])&gdp$gdp_growth[i]<0){
gdp$log2[i]<-(0-gdp$log[i])
}
}
for(i in 1:nrow(gdp)){
if(!is.na(gdp$gdp_growth[i]) & gdp$gdp_growth[i]>=0){
gdp$log2[i]<-gdp$log[i]
}else if(!is.na(gdp$gdp_growth[i])&gdp$gdp_growth[i]<0){
gdp$log2[i]<-(0-gdp$log[i])
}else if(is.na(gdp$gdp_growth[i])){
gdp$log2[i]<-NA
}
}
gdp<-WDI(country="all",indicator="NY.GDP.MKTP.KD.ZG", start=2005, extra=F)
gdp$NY.GDP.MKTP.KD.ZG<-round(gdp$NY.GDP.MKTP.KD.ZG,2)
gdp<-filter(gdp, !country %in% unique(gdp$country)[1:49])
gdp<-rename(gdp, Year=year, name=country, gdp_growth=`NY.GDP.MKTP.KD.ZG`)
gdp$z<-(gdp$gdp_growth-mean(gdp$gdp_growth, na.rm=T))/sd(gdp$gdp_growth,na.rm = T)
range(gdp$gdp_growth)
range(gdp$gdp_growth,na.rm=T)
range(gdp$z,na.rm=T)
runApp('Mappy_Appy2.R')
worldmap = readOGR(dsn="Nat_world_map", layer="ne_50m_admin_0_countries")
worldmap@data[worldmap@data$NAME=="United States of America",]$NAME<-"United States"
worldmap@data[worldmap@data$NAME=="Congo",]$NAME<-"Rep. of Congo"
worldmap@data[worldmap@data$NAME=="South Korea",]$NAME<-"Korea"
worldmap@data[worldmap@data$NAME=="North Korea",]$NAME<-"Dem. Rep. Korea"
worldmap@data[worldmap@data$NAME=="Czechia",]$NAME<-"Czech Rep."
worldmap@data[worldmap@data$NAME==unique(worldmap@data$NAME)[grep("Ivoi",unique(worldmap@data$NAME))],]$NAME<-"Cote d'Ivoire"
worldmap@data[worldmap@data$NAME=="Cabo Verde",]$NAME<-"Cape Verde"
worldmap@data[worldmap@data$NAME=="Trinidad and Tobago",]$NAME<-"Trinidad & Tobago"
worldmap@data[worldmap@data$NAME=="Eq. Guinea",]$NAME<-"Equatorial Guinea"
worldmap@data[worldmap@data$NAME=="Bosnia and Herz.",]$NAME<-"Bosnia"
worldmap@data[worldmap@data$NAME=="Antigua and Barb.",]$NAME<-"Antigua and Barbuda"
worldmap@data[worldmap@data$NAME=="Solomon Is.",]$NAME<-"Solomon Islands"
worldmap@data[worldmap@data$NAME==unique(worldmap@data$NAME)[grep("Tom",unique(worldmap@data$NAME))],]$NAME<-"Sao Tome"
worldmap@data[worldmap@data$NAME_EN=="People's Republic of China",]$NAME_EN<-"China"
worldmap@data[worldmap@data$NAME_EN=="Ivory Coast",]$NAME_EN<-"Cote d'Ivoire"
worldmap@data[worldmap@data$NAME_EN=="Democratic Republic of the Congo",]$NAME_EN<-"Congo, Dem. Rep."
worldmap@data[worldmap@data$NAME_EN=="Republic of the Congo",]$NAME_EN<-"Congo, Rep."
worldmap@data[worldmap@data$NAME_EN=="Cape Verde",]$NAME_EN<-"Cabo Verde"
worldmap@data[worldmap@data$NAME_EN=="Egypt",]$NAME_EN<-"Egypt, Arab Rep."
worldmap@data[worldmap@data$NAME_EN=="Iran",]$NAME_EN<-"Iran, Islamic Rep."
worldmap@data[worldmap@data$NAME_EN=="Federated States of Micronesia",]$NAME_EN<-"Micronesia, Fed. Sts."
worldmap@data[worldmap@data$NAME_EN=="The Gambia",]$NAME_EN<-"Gambia, The"
worldmap@data[worldmap@data$NAME_EN=="Kyrgyzstan",]$NAME_EN<-"Kyrgyz Republic"
worldmap@data[worldmap@data$NAME_EN=="Saint Kitts and Nevis",]$NAME_EN<-"St. Kitts and Nevis"
worldmap@data[worldmap@data$NAME_EN=="Laos",]$NAME_EN<-"Lao PDR"
worldmap@data[worldmap@data$NAME_EN=="Russia",]$NAME_EN<-"Russian Federation"
worldmap@data[worldmap@data$NAME_EN=="Venezuela",]$NAME_EN<-"Venezuela, RB"
worldmap@data[worldmap@data$NAME_EN=="Yemen",]$NAME_EN<-"Yemen, Rep."
worldmap@data[worldmap@data$NAME_EN=="Saint Lucia",]$NAME_EN<-"St. Lucia"
worldmap@data[worldmap@data$NAME_EN==unique(worldmap@data$NAME_EN)[grep("Tom", unique(worldmap@data$NAME_EN))],]$NAME_EN<-"Sao Tome and Principe"
worldmap@data[worldmap@data$NAME_EN=="East Timor",]$NAME_EN<-"Timor-Leste"
worldmap@data[worldmap@data$NAME_EN=="Syria",]$NAME_EN<-"Syrian Arab Republic"
worldmap@data[worldmap@data$NAME_EN=="The Bahamas",]$NAME_EN<-"Bahamas, The"
worldmap@data[worldmap@data$NAME_EN=="Hong Kong",]$NAME_EN<-"Hong Kong SAR, China"
worldmap@data[worldmap@data$NAME_EN=="North Korea",]$NAME_EN<-"Korea, Dem. People's Rep."
worldmap@data[worldmap@data$NAME_EN=="South Korea",]$NAME_EN<-"Korea, Rep."
worldmap@data[worldmap@data$NAME_EN=="Saint Vincent and the Grenadines",]$NAME_EN<-"St. Vincent and the Grenadines"
worldmap@data[worldmap@data$NAME_EN=="United States of America",]$NAME_EN<-"United States"
worldmap@data[worldmap@data$NAME_EN=="Sint Maarten",]$NAME_EN<-"Sint Maarten (Dutch Part)"
worldmap@data[worldmap@data$NAME_EN=="Saint Martin",]$NAME_EN<-"Saint Martin (French Part)"
worldmap@data[worldmap@data$NAME_EN=="Slovakia",]$NAME_EN<-"Slovak Republic"
worldmap@data[worldmap@data$NAME_EN=="United States Virgin Islands",]$NAME_EN<-"Virgin Islands (U.S.)"
chn_inv<-read.csv('China-Global-Investment-Tracker-2021-Fall-FINAL-2022.2.21-update.up.csv')
chn_inv<-chn_inv %>%
group_by(Year, Country) %>%
mutate(inv_tot = sum(as.numeric(gsub("[[:punct:]]", "", Quantity.in.Millions))))
chn_inv$Country<-stringr::str_to_lower(chn_inv$Country)
chn_inv[chn_inv$Country=="britain",]$Country<-"uk"
chn_inv[chn_inv$Country=="myanmar",]$Country<-"burma"
chn_inv[chn_inv$Country=="russian federation",]$Country<-"russia"
chn_inv[chn_inv$Country=="trinidad-tobago",]$Country<-"trinidad and tobago"
chn_inv[chn_inv$Country=="bosnia",]$Country<-"bosnia and herzegovina"
chn_inv[chn_inv$Country=="sao tome",]$Country<-"uk"
inv_y<-filter(chn_inv, Year==input$year)
inv_y<-inv_y[!duplicated(inv_y$Country),c("Country","inv_tot")]
inv_y$inv_tot<-as.numeric(inv_y$inv_tot)
worldmap@data$sov_low<-stringr::str_to_lower(worldmap@data$SOVEREIGNT)
worldmap@data[worldmap@data$sov_low=="the bahamas",]$sov_low<-"bahamas"
worldmap@data[worldmap@data$sov_low=="united kingdom",]$sov_low<-"uk"
worldmap@data[worldmap@data$sov_low=="united states of america",]$sov_low<-"usa"
worldmap@data[worldmap@data$sov_low=="united arab emirates",]$sov_low<-"uae"
worldmap@data[worldmap@data$sov_low=="czechia",]$sov_low<-"czech republic"
worldmap@data[worldmap@data$sov_low=="east timor",]$sov_low<-"timor-leste"
worldmap@data[worldmap@data$sov_low=="united republic of tanzania",]$sov_low<-"tanzania"
worldmap@data<-left_join(worldmap@data, inv_y, by=c("sov_low"="Country"))
chn_inv<-read.csv('China-Global-Investment-Tracker-2021-Fall-FINAL-2022.2.21-update.up.csv')
chn_inv<-chn_inv %>%
group_by(Year, Country) %>%
mutate(inv_tot = sum(as.numeric(gsub("[[:punct:]]", "", Quantity.in.Millions))))
chn_inv$Country<-stringr::str_to_lower(chn_inv$Country)
chn_inv[chn_inv$Country=="britain",]$Country<-"uk"
chn_inv[chn_inv$Country=="myanmar",]$Country<-"burma"
chn_inv[chn_inv$Country=="russian federation",]$Country<-"russia"
chn_inv[chn_inv$Country=="trinidad-tobago",]$Country<-"trinidad and tobago"
chn_inv[chn_inv$Country=="bosnia",]$Country<-"bosnia and herzegovina"
chn_inv[chn_inv$Country=="sao tome",]$Country<-"uk"
inv_y<-filter(chn_inv, Year==2015)
inv_y<-inv_y[!duplicated(inv_y$Country),c("Country","inv_tot")]
inv_y$inv_tot<-as.numeric(inv_y$inv_tot)
worldmap@data$sov_low<-stringr::str_to_lower(worldmap@data$SOVEREIGNT)
worldmap@data[worldmap@data$sov_low=="the bahamas",]$sov_low<-"bahamas"
worldmap@data[worldmap@data$sov_low=="united kingdom",]$sov_low<-"uk"
worldmap@data[worldmap@data$sov_low=="united states of america",]$sov_low<-"usa"
worldmap@data[worldmap@data$sov_low=="united arab emirates",]$sov_low<-"uae"
worldmap@data[worldmap@data$sov_low=="czechia",]$sov_low<-"czech republic"
worldmap@data[worldmap@data$sov_low=="east timor",]$sov_low<-"timor-leste"
worldmap@data[worldmap@data$sov_low=="united republic of tanzania",]$sov_low<-"tanzania"
worldmap@data<-left_join(worldmap@data, inv_y, by=c("sov_low"="Country"))
dem<-filter(vdem[c("country_name","country_text_id","year","v2x_libdem")],year>2004)
dem[dem$country_text_id=="XKX",]$country_text_id<-"KOS"
dem[dem$country_text_id=="SSD",]$country_text_id<-"SDS"
dem[dem$country_text_id=="PSE",]$country_text_id<-"PSX"
dem[dem$country_text_id=="SML",]$country_text_id<-"SOL"
dem<-filter(rename(dem, Year=year, name=country_name, dem_score=v2x_libdem), Year==2015)
worldmap@data<-left_join(worldmap@data, dem, by=c("ADM0_A3"="country_text_id"))
View(worldmap@data)
runApp('Mappy_Appy2.R')
typeof(dem$dem_score)
colorNumeric(palette="Reds", domain=dat_c()@data$dem_score)
j<-colorNumeric(palette="Reds", domain=worldmap@data$dem_score)
j
j(worldmap@data$dem_score)
View(dem)
runApp('Mappy_Appy2.R')
runApp('Mappy_Appy2.R')
runApp('Mappy_Appy2.R')
gdp$min_max<-(gdp$gdp_growth-min(gdp$gdp_growth, na.rm=T))/(max(gdp$gdp_growth,na.rm=T)-min(gdp$gdp_growth,na.rm=T))
runApp('Mappy_Appy2.R')
runApp('Mappy_Appy2.R')
gdp$growth_fac<-ifelse(gdp$gdp_growth<-10,1,0)
gdp<-WDI(country="all",indicator="NY.GDP.MKTP.KD.ZG", start=2005, extra=F)
gdp$NY.GDP.MKTP.KD.ZG<-round(gdp$NY.GDP.MKTP.KD.ZG,2)
gdp<-filter(gdp, !country %in% unique(gdp$country)[1:49])
gdp<-rename(gdp, Year=year, name=country, gdp_growth=`NY.GDP.MKTP.KD.ZG`)
#gdp$z<-(gdp$gdp_growth-mean(gdp$gdp_growth, na.rm=T))/sd(gdp$gdp_growth,na.rm = T)
#gdp$mean_scaled<-(gdp$gdp_growth/mean(gdp$gdp_growth,na.rm=T))
#gdp$min_max<-(gdp$gdp_growth-min(gdp$gdp_growth, na.rm=T))/(max(gdp$gdp_growth,na.rm=T)-min(gdp$gdp_growth,na.rm=T))
gdp$growth_fac<-ifelse(-10>gdp$gdp_growth,1,0)
gdp$growth_fac<-ifelse(-10>gdp$gdp_growth,1, ifelse(gdp$gdp_growth< -2 & gdp$gdp_growth>-10, 2, 0))
gdp$growth_fac<-ifelse(-10>=gdp$gdp_growth,1, ifelse(gdp$gdp_growth<= -2.5 & gdp$gdp_growth>-10, 2, ifelse(gdp$gdp_growth<= 0 & gdp$gdp_growth>-2.5, 3, ifelse(gdp$gdp_growth<= 2.5 & gdp$gdp_growth>0, 4, ifelse(gdp$gdp_growth<= 5 & gdp$gdp_growth>2.5, 5, ifelse(gdp$gdp_growth<= 10 & gdp$gdp_growth>5, 6, ifelse(gdp$gdp_growth>10, 7, 0)))))))
runApp('Mappy_Appy2.R')
runApp('Mappy_Appy2.R')
runApp('Mappy_Appy2.R')
