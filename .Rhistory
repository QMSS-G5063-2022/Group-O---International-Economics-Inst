worldmap@data[worldmap@data$NAME=="North Korea",]$NAME<-"Dem. Rep. Korea"
worldmap@data[worldmap@data$NAME=="Czechia",]$NAME<-"Czech Rep."
worldmap@data[worldmap@data$NAME==unique(worldmap@data$NAME)[grep("Ivoi",unique(worldmap@data$NAME))],]$NAME<-"Cote d'Ivoire"
worldmap@data[worldmap@data$NAME=="Cabo Verde",]$NAME<-"Cape Verde"
worldmap@data[worldmap@data$NAME=="Trinidad and Tobago",]$NAME<-"Trinidad & Tobago"
worldmap@data[worldmap@data$NAME=="Eq. Guinea",]$NAME<-"Equatorial Guinea"
worldmap@data[worldmap@data$NAME=="Bosnia and Herz.",]$NAME<-"Bosnia"
worldmap@data[worldmap@data$NAME=="Antigua and Barb.",]$NAME<-"Antigua and Barbuda"
worldmap@data[worldmap@data$NAME=="Solomon Is.",]$NAME<-"Solomon Islands"
worldmap@data[worldmap@data$NAME==unique(worldmap@data$NAME)[grep("Tom",unique(worldmap@data$NAME))],]$NAME<-"Sao Tome"
worldmap@data[worldmap@data$NAME_EN=="People's Republic of China",]$NAME_EN<-"China"
worldmap@data[worldmap@data$NAME_EN=="Ivory Coast",]$NAME_EN<-"Cote d'Ivoire"
worldmap@data[worldmap@data$NAME_EN=="Democratic Republic of the Congo",]$NAME_EN<-"Congo, Dem. Rep."
worldmap@data[worldmap@data$NAME_EN=="Republic of the Congo",]$NAME_EN<-"Congo, Rep."
worldmap@data[worldmap@data$NAME_EN=="Cape Verde",]$NAME_EN<-"Cabo Verde"
worldmap@data[worldmap@data$NAME_EN=="Egypt",]$NAME_EN<-"Egypt, Arab Rep."
worldmap@data[worldmap@data$NAME_EN=="Iran",]$NAME_EN<-"Iran, Islamic Rep."
worldmap@data[worldmap@data$NAME_EN=="Federated States of Micronesia",]$NAME_EN<-"Micronesia, Fed. Sts."
worldmap@data[worldmap@data$NAME_EN=="The Gambia",]$NAME_EN<-"Gambia, The"
worldmap@data[worldmap@data$NAME_EN=="Kyrgyzstan",]$NAME_EN<-"Kyrgyz Republic"
worldmap@data[worldmap@data$NAME_EN=="Saint Kitts and Nevis",]$NAME_EN<-"St. Kitts and Nevis"
worldmap@data[worldmap@data$NAME_EN=="Laos",]$NAME_EN<-"Lao PDR"
worldmap@data[worldmap@data$NAME_EN=="Russia",]$NAME_EN<-"Russian Federation"
worldmap@data[worldmap@data$NAME_EN=="Venezuela",]$NAME_EN<-"Venezuela, RB"
worldmap@data[worldmap@data$NAME_EN=="Yemen",]$NAME_EN<-"Yemen, Rep."
worldmap@data[worldmap@data$NAME_EN=="Saint Lucia",]$NAME_EN<-"St. Lucia"
worldmap@data[worldmap@data$NAME_EN==unique(worldmap@data$NAME_EN)[grep("Tom", unique(worldmap@data$NAME_EN))],]$NAME_EN<-"Sao Tome and Principe"
worldmap@data[worldmap@data$NAME_EN=="East Timor",]$NAME_EN<-"Timor-Leste"
worldmap@data[worldmap@data$NAME_EN=="Syria",]$NAME_EN<-"Syrian Arab Republic"
worldmap@data[worldmap@data$NAME_EN=="The Bahamas",]$NAME_EN<-"Bahamas, The"
worldmap@data[worldmap@data$NAME_EN=="Hong Kong",]$NAME_EN<-"Hong Kong SAR, China"
worldmap@data[worldmap@data$NAME_EN=="North Korea",]$NAME_EN<-"Korea, Dem. People's Rep."
worldmap@data[worldmap@data$NAME_EN=="South Korea",]$NAME_EN<-"Korea, Rep."
worldmap@data[worldmap@data$NAME_EN=="Saint Vincent and the Grenadines",]$NAME_EN<-"St. Vincent and the Grenadines"
worldmap@data[worldmap@data$NAME_EN=="United States of America",]$NAME_EN<-"United States"
worldmap@data[worldmap@data$NAME_EN=="Sint Maarten",]$NAME_EN<-"Sint Maarten (Dutch Part)"
worldmap@data[worldmap@data$NAME_EN=="Saint Martin",]$NAME_EN<-"Saint Martin (French Part)"
worldmap@data[worldmap@data$NAME_EN=="Slovakia",]$NAME_EN<-"Slovak Republic"
worldmap@data[worldmap@data$NAME_EN=="United States Virgin Islands",]$NAME_EN<-"Virgin Islands (U.S.)"
imf<-WDI(indicator = "DT.DOD.DIMF.CD", country="all",start=2005, extra=F)
imf<-filter(imf, !country %in% unique(imf$country)[1:49])
imf<-rename(imf, Year=year, name=country, IMF_cred=DT.DOD.DIMF.CD)
inv_y<-filter(imf, Year==2015)[c("name","IMF_cred")]
worldmap@data[worldmap@data$NAME_EN=="Brunei",]$NAME_EN<-"Brunei Darussalam"
worldmap@data[worldmap@data$NAME_EN==unique(worldmap@data$NAME_EN)[grep("Cura",worldmap@data$NAME_EN)],]$NAME_EN<-"Curacao"
worldmap@data<-left_join(worldmap@data, inv_y, by=c("NAME_EN"="name"))
rawnodes<-read.csv('http://www.kateto.net/wordpress/wp-content/uploads/2015/06/Country_terms_FREQ.csv')
rawedges<-read.csv('http://www.kateto.net/wordpress/wp-content/uploads/2015/06/Country_terms_COOC.csv')
imf<-WDI(indicator = "DT.DOD.DIMF.CD", country="all",start=2005, extra=F)
imf<-filter(imf, !country %in% unique(imf$country)[1:49])
imf<-rename(imf, Year=year, name=country, IMF_cred=DT.DOD.DIMF.CD)
worldmap@data[worldmap@data$NAME_EN=="Brunei",]$NAME_EN<-"Brunei Darussalam"
net_dat<-filter(imf, Year==min(imf$Year))[!duplicated(filter(imf, Year==min(imf$Year))$name), c("name","Year","IMF_cred")]
for(o in unique(imf$Year)[-1]){
net_dat<-rbind(net_dat, filter(imf, Year==o)[!duplicated(filter(imf, Year==o)$name), c("name", "Year", "IMF_cred")])
}
net_dat["Source"]<-rep("imf",nrow(net_dat))
net_dat<-net_dat[c(4,1,2,3)]
colnames(net_dat)[2]<-"Target"
nodes<-rename(rawnodes[c("ID","lon","lat")],name=ID)
net_dat$Target<-stringr::str_to_lower(net_dat$Target)
nodes<-rbind(nodes, c("imf", round(-77.04425201622206,6), round(38.89908346600995,6)))
nodes<-rbind(nodes, c("American Samoa", round(-170.5794322853497,6), round(-14.26012915103479,6)))
nodes<-rbind(nodes, c("comoros", round(43.48504853332502,6),round(-11.862176383838756,6)))
nodes<-rbind(nodes,c("republic of the congo", round(16.052629791985225,6), round(-0.07691295959726356,6)))
nodes<-rbind(nodes,c("democratic republic of the congo", round(23.84214068136281,6), round(-3.2141630381290125,6)))
nodes<-rbind(nodes,c("ivory coast", round(-5.529500409752393,6),round(7.253827157140813,6)))
nodes<-rbind(nodes,c("eswatini", round(31.526906430335316,6), round(-26.50532674658614, 6)))
nodes<-rbind(nodes,c("guinea-bissau", round(-15.11433094944025,6),round(11.849168222767416,6)))
nodes<-rbind(nodes, c("sao tome and principe", round(6.637044051405797,6), round(0.3877357338129725, 6)))
nodes<-rbind(nodes, c("saint lucia", round(-60.981555430152405,6), round(13.890030848573293,6)))
nodes<-rbind(nodes, c("saint vincent and the grenadines", round(-61.25999737205744,6), round(12.990774451382883,6)))
nodes[nodes$name=="uk",]$name<-"united kingdom"
nodes[nodes$name=="uae",]$name<-"united arab emirates"
nodes[nodes$name=="brunei",]$name<-"brunei darussalam"
nodes[nodes$name=="macedonia",]$name<-"north macedonia"
nodes[nodes$name=="burma",]$name<-"myanmar"
nodes<-filter(nodes, name %in% c(filter(net_dat, Year==2015 & !is.na(IMF_cred))$Target,"imf"))
nodes$id<-as.integer(rownames(nodes))
nodes<-nodes[c(4,2,3,1)]
h<-dplyr::rename(filter(net_dat,Year==2015 & !is.na(IMF_cred))[c("Source", "Target", "IMF_cred")], FROM=Source, TO=Target)
u<-nodes[c(4,3,2)]
network_<-get.data.frame(graph.data.frame(h, directed=T, vertices=u), "both")
verts_<-network_$vertices
verts_$lat<-as.numeric(verts_$lat)
verts_$lon<-as.numeric(verts_$lon)
coordinates(verts_)<-~lon+lat
network_<-get.data.frame(graph.data.frame(h, directed=T, vertices=u), "both")
View(h)
View(u)
setdiff(h$name, u$name)
setdiff(h$FROM, u$name)
"imf" %in% u$name
network_<-get.data.frame(graph.data.frame(h, directed=T, vertices=u), "both")
setdiff(h$TO, u$name)
rawnodes<-read.csv('http://www.kateto.net/wordpress/wp-content/uploads/2015/06/Country_terms_FREQ.csv')
rawedges<-read.csv('http://www.kateto.net/wordpress/wp-content/uploads/2015/06/Country_terms_COOC.csv')
imf<-WDI(indicator = "DT.DOD.DIMF.CD", country="all",start=2005, extra=F)
imf<-filter(imf, !country %in% unique(imf$country)[1:49])
imf<-rename(imf, Year=year, name=country, IMF_cred=DT.DOD.DIMF.CD)
worldmap@data[worldmap@data$NAME_EN=="Brunei",]$NAME_EN<-"Brunei Darussalam"
worldmap@data[worldmap@data$NAME_EN==unique(worldmap@data$NAME_EN)[grep("Cura",worldmap@data$NAME_EN)],]$NAME_EN<-"Curacao"
net_dat<-filter(imf, Year==min(imf$Year))[!duplicated(filter(imf, Year==min(imf$Year))$name), c("name","Year","IMF_cred")]
for(o in unique(imf$Year)[-1]){
net_dat<-rbind(net_dat, filter(imf, Year==o)[!duplicated(filter(imf, Year==o)$name), c("name", "Year", "IMF_cred")])
}
net_dat["Source"]<-rep("imf",nrow(net_dat))
net_dat<-net_dat[c(4,1,2,3)]
colnames(net_dat)[2]<-"Target"
nodes<-rename(rawnodes[c("ID","lon","lat")],name=ID)
net_dat$Target<-stringr::str_to_lower(net_dat$Target)
nodes<-rbind(nodes, c("imf", round(-77.04425201622206,6), round(38.89908346600995,6)))
nodes<-rbind(nodes, c("American Samoa", round(-170.5794322853497,6), round(-14.26012915103479,6)))
nodes<-rbind(nodes, c("comoros", round(43.48504853332502,6),round(-11.862176383838756,6)))
nodes<-rbind(nodes,c("republic of the congo", round(16.052629791985225,6), round(-0.07691295959726356,6)))
nodes<-rbind(nodes,c("democratic republic of the congo", round(23.84214068136281,6), round(-3.2141630381290125,6)))
nodes<-rbind(nodes,c("ivory coast", round(-5.529500409752393,6),round(7.253827157140813,6)))
nodes<-rbind(nodes,c("eswatini", round(31.526906430335316,6), round(-26.50532674658614, 6)))
nodes<-rbind(nodes,c("guinea-bissau", round(-15.11433094944025,6),round(11.849168222767416,6)))
nodes<-rbind(nodes, c("sao tome and principe", round(6.637044051405797,6), round(0.3877357338129725, 6)))
nodes<-rbind(nodes, c("saint lucia", round(-60.981555430152405,6), round(13.890030848573293,6)))
nodes<-rbind(nodes, c("saint vincent and the grenadines", round(-61.25999737205744,6), round(12.990774451382883,6)))
setdiff(net_dat$Target, nodes$name)
nodes[nodes$name=="uk",]$name<-"united kingdom"
nodes[nodes$name=="uae",]$name<-"united arab emirates"
nodes[nodes$name=="brunei",]$name<-"brunei darussalam"
nodes[nodes$name=="macedonia",]$name<-"north macedonia"
nodes[nodes$name=="burma",]$name<-"myanmar"
setdiff(net_dat$Target, nodes$name)
unique(nodes$name)[grep("hamas"), unique(nodes$name)]
unique(nodes$name)[grep("hamas", unique(nodes$name))]
nodes[nodes$name=="bahamas",]$name<-"bahamas, the"
unique(nodes$name)[grep("hamas"), unique(nodes$name)]
setdiff(net_dat$Target, nodes$name)
unique(nodes$name)[grep("amoa", unique(nodes$name))]
unique(nodes$name)[grep("ermuda", unique(nodes$name))]
unique(nodes$name)[grep("muda", unique(nodes$name))]
unique(nodes$name)[grep("virgin", unique(nodes$name))]
unique(nodes$name)[grep("erd", unique(nodes$name))]
unique(nodes$name)[grep("ayman", unique(nodes$name))]
unique(nodes$name)[grep("congo", unique(nodes$name))]
unique(nodes$name)[grep("v",o unique(nodes$name))]
unique(nodes$name)[grep("ivo", unique(nodes$name))]
unique(nodes$name)[grep("egypt", unique(nodes$name))]
nodes[nodes$name=="cape verde",]$name<-"cabo verde"
nodes[nodes$name=="republic of the congo",]$name<-"congo, dem. rep."
nodes[nodes$name=="democratic republic of the congo",]$name<-"congo, rep."
nodes[nodes$name=="ivory coast",]$name<-"cote d'ivoire"
nodes[nodes$name=="egypt",]$name<-"egypt, arab rep."
setdiff(net_dat$Target, nodes$name)
unique(nodes$name)[grep("hong", unique(nodes$name))]
unique(nodes$name)[grep("kroea", unique(nodes$name))]
unique(nodes$name)[grep("korea", unique(nodes$name))]
unique(nodes$name)[grep("kyr", unique(nodes$name))]
unique(nodes$name)[grep("lao", unique(nodes$name))]
unique(nodes$name)[grep("macao", unique(nodes$name))]
unique(nodes$name)[grep("micro", unique(nodes$name))]
setdiff(net_dat$Target, nodes$name)
nodes[nodes$name=="hong kong",]$name<-"hong kong sar, china"
nodes[nodes$name=="north korea",]$name<-"korea, dem. people's rep."
nodes[nodes$name=="south korea",]$name<-"korea, rep."
nodes[nodes$name=="kyrgzstan",]$name<-"kyrgyz republic"
nodes[nodes$name=="laos",]$name<-"lao pdr"
setdiff(net_dat$Target, nodes$name)
unique(nodes$name)[grep("gambia", unique(nodes$name))]
unique(nodes$name)[grep("ky", unique(nodes$name))]
nodes[nodes$name=="kyrgyzstan",]$name<-"kyrgyz republic"
setdiff(net_dat$Target, nodes$name)
unique(nodes$name)[grep("aar", unique(nodes$name))]
unique(nodes$name)[grep("art", unique(nodes$name))]
unique(nodes$name)[grep("lucia", unique(nodes$name))]
unique(nodes$name)[grep("States", unique(nodes$name))]
unique(nodes$name)[grep("US", unique(nodes$name))]
unique(nodes$name)[grep("states", unique(nodes$name))]
unique(nodes$name)[grep("us", unique(nodes$name))]
nodes[nodes$name=="micronesia",]$name<-"micronesia, fed. sts."
nodes[nodes$name=="russia",]$name<-"russian federation"
nodes[nodes$name=="syria",]$name<-"syrian arab republic"
nodes[nodes$name=="venezuela",]$name<-"venezuela, rb"
nodes[nodes$name=="yemen",]$name<-"yemen, rep."
nodes[nodes$name=="usa",]$name<-"united states"
setdiff(net_dat$Target, nodes$name)
nodes[nodes$name=="gambia",]$name<-"gambia, the"
setdiff(net_dat$Target, nodes$name)
unique(nodes$name)[grep("slov", unique(nodes$name))]
rawnodes<-read.csv('http://www.kateto.net/wordpress/wp-content/uploads/2015/06/Country_terms_FREQ.csv')
rawedges<-read.csv('http://www.kateto.net/wordpress/wp-content/uploads/2015/06/Country_terms_COOC.csv')
imf<-WDI(indicator = "DT.DOD.DIMF.CD", country="all",start=2005, extra=F)
imf<-filter(imf, !country %in% unique(imf$country)[1:49])
imf<-rename(imf, Year=year, name=country, IMF_cred=DT.DOD.DIMF.CD)
# imf[imf$name=="United States",]$name<-"USA"
# imf[imf$name=="Venezuela, RB",]$name<-"Venezuela"
# imf[imf$name=="Virgin Islands (U.S.)",]$name<-"United States Virgin Islands"
# imf[imf$name=="Yemen, Rep.",]$name<-"Yemen"
worldmap@data[worldmap@data$NAME_EN=="Brunei",]$NAME_EN<-"Brunei Darussalam"
#worldmap@data[worldmap@data$NAME_EN=="People's Republic of China",]$NAME_EN<-"China"
#worldmap@data[worldmap@data$NAME_EN=="The Gambia",]$NAME_EN<-"Gambia"
#worldmap@data[worldmap@data$NAME_EN=="Federated States of Micronesia",]$NAME_EN<-"Micronesia"
#worldmap@data[worldmap@data$NAME_EN=="United States of America",]$NAME_EN<-"USA"
worldmap@data[worldmap@data$NAME_EN==unique(worldmap@data$NAME_EN)[grep("Cura",worldmap@data$NAME_EN)],]$NAME_EN<-"Curacao"
net_dat<-filter(imf, Year==min(imf$Year))[!duplicated(filter(imf, Year==min(imf$Year))$name), c("name","Year","IMF_cred")]
for(o in unique(imf$Year)[-1]){
net_dat<-rbind(net_dat, filter(imf, Year==o)[!duplicated(filter(imf, Year==o)$name), c("name", "Year", "IMF_cred")])
}
net_dat["Source"]<-rep("imf",nrow(net_dat))
net_dat<-net_dat[c(4,1,2,3)]
colnames(net_dat)[2]<-"Target"
nodes<-rename(rawnodes[c("ID","lon","lat")],name=ID)
net_dat$Target<-stringr::str_to_lower(net_dat$Target)
nodes<-rbind(nodes, c("imf", round(-77.04425201622206,6), round(38.89908346600995,6)))
nodes<-rbind(nodes, c("american samoa", round(-170.5794322853497,6), round(-14.26012915103479,6)))
nodes<-rbind(nodes, c("comoros", round(43.48504853332502,6),round(-11.862176383838756,6)))
nodes<-rbind(nodes,c("congo, rep.", round(16.052629791985225,6), round(-0.07691295959726356,6)))
nodes<-rbind(nodes,c("congo, dem. rep.", round(23.84214068136281,6), round(-3.2141630381290125,6)))
nodes<-rbind(nodes,c("cote d'ivoire", round(-5.529500409752393,6),round(7.253827157140813,6)))
nodes<-rbind(nodes,c("eswatini", round(31.526906430335316,6), round(-26.50532674658614, 6)))
nodes<-rbind(nodes,c("guinea-bissau", round(-15.11433094944025,6),round(11.849168222767416,6)))
nodes<-rbind(nodes, c("sao tome and principe", round(6.637044051405797,6), round(0.3877357338129725, 6)))
nodes<-rbind(nodes, c("st. lucia", round(-60.981555430152405,6), round(13.890030848573293,6)))
nodes<-rbind(nodes, c("st. vincent and the grenadines", round(-61.25999737205744,6), round(12.990774451382883,6)))
nodes[nodes$name=="uk",]$name<-"united kingdom"
nodes[nodes$name=="uae",]$name<-"united arab emirates"
nodes[nodes$name=="brunei",]$name<-"brunei darussalam"
nodes[nodes$name=="macedonia",]$name<-"north macedonia"
nodes[nodes$name=="burma",]$name<-"myanmar"
nodes[nodes$name=="bahamas",]$name<-"bahamas, the"
nodes[nodes$name=="cape verde",]$name<-"cabo verde"
nodes[nodes$name=="egypt",]$name<-"egypt, arab rep."
nodes[nodes$name=="hong kong",]$name<-"hong kong sar, china"
nodes[nodes$name=="north korea",]$name<-"korea, dem. people's rep."
nodes[nodes$name=="south korea",]$name<-"korea, rep."
nodes[nodes$name=="kyrgyzstan",]$name<-"kyrgyz republic"
nodes[nodes$name=="laos",]$name<-"lao pdr"
nodes[nodes$name=="gambia",]$name<-"gambia, the"
nodes[nodes$name=="micronesia",]$name<-"micronesia, fed. sts."
nodes[nodes$name=="russia",]$name<-"russian federation"
nodes[nodes$name=="syria",]$name<-"syrian arab republic"
nodes[nodes$name=="venezuela",]$name<-"venezuela, rb"
nodes[nodes$name=="yemen",]$name<-"yemen, rep."
nodes[nodes$name=="usa",]$name<-"united states"
nodes[nodes$name=="iran",]$name<-"iran, islamic rep."
nodes[nodes$name=="slovakia",]$name<-"slovak republic"
nodes<-filter(nodes, name %in% c(filter(net_dat, Year==input$year & !is.na(IMF_cred))$Target,"imf"))
nodes$id<-as.integer(rownames(nodes))
nodes<-nodes[c(4,2,3,1)]
nodes<-filter(nodes, name %in% c(filter(net_dat, Year==2015 & !is.na(IMF_cred))$Target,"imf"))
nodes$id<-as.integer(rownames(nodes))
nodes<-nodes[c(4,2,3,1)]
h<-dplyr::rename(filter(net_dat,Year==2015 & !is.na(IMF_cred))[c("Source", "Target", "IMF_cred")], FROM=Source, TO=Target)
u<-nodes[c(4,3,2)]
network_<-get.data.frame(graph.data.frame(h, directed=T, vertices=u), "both")
setdiff(h$TO, u$id)
View(nodes)
u<-nodes[c("name", "lat","lon")]
network_<-get.data.frame(graph.data.frame(h, directed=T, vertices=u), "both")
setdiff(h$TO, u$name)
unique(u$name)[grep("timor", unique(u$name))]
nodes<-rbind(nodes, c("timor-leste", round(126.04154797375384,6), round(-8.779762146492265,6)))
nodes<-filter(nodes, name %in% c(filter(net_dat, Year==input$year & !is.na(IMF_cred))$Target,"imf"))
nodes<-rename(rawnodes[c("ID","lon","lat")],name=ID)
net_dat$Target<-stringr::str_to_lower(net_dat$Target)
nodes<-rbind(nodes, c("imf", round(-77.04425201622206,6), round(38.89908346600995,6)))
nodes<-rbind(nodes, c("american samoa", round(-170.5794322853497,6), round(-14.26012915103479,6)))
nodes<-rbind(nodes, c("comoros", round(43.48504853332502,6),round(-11.862176383838756,6)))
nodes<-rbind(nodes,c("congo, rep.", round(16.052629791985225,6), round(-0.07691295959726356,6)))
nodes<-rbind(nodes,c("congo, dem. rep.", round(23.84214068136281,6), round(-3.2141630381290125,6)))
nodes<-rbind(nodes,c("cote d'ivoire", round(-5.529500409752393,6),round(7.253827157140813,6)))
nodes<-rbind(nodes,c("eswatini", round(31.526906430335316,6), round(-26.50532674658614, 6)))
nodes<-rbind(nodes,c("guinea-bissau", round(-15.11433094944025,6),round(11.849168222767416,6)))
nodes<-rbind(nodes, c("sao tome and principe", round(6.637044051405797,6), round(0.3877357338129725, 6)))
nodes<-rbind(nodes, c("st. lucia", round(-60.981555430152405,6), round(13.890030848573293,6)))
nodes<-rbind(nodes, c("st. vincent and the grenadines", round(-61.25999737205744,6), round(12.990774451382883,6)))
nodes<-rbind(nodes, c("timor-leste", round(126.04154797375384,6), round(-8.779762146492265,6)))
nodes[nodes$name=="uk",]$name<-"united kingdom"
nodes[nodes$name=="uae",]$name<-"united arab emirates"
nodes[nodes$name=="brunei",]$name<-"brunei darussalam"
nodes[nodes$name=="macedonia",]$name<-"north macedonia"
nodes[nodes$name=="burma",]$name<-"myanmar"
nodes[nodes$name=="bahamas",]$name<-"bahamas, the"
nodes[nodes$name=="cape verde",]$name<-"cabo verde"
nodes[nodes$name=="egypt",]$name<-"egypt, arab rep."
nodes[nodes$name=="hong kong",]$name<-"hong kong sar, china"
nodes[nodes$name=="north korea",]$name<-"korea, dem. people's rep."
nodes[nodes$name=="south korea",]$name<-"korea, rep."
nodes[nodes$name=="kyrgyzstan",]$name<-"kyrgyz republic"
nodes[nodes$name=="laos",]$name<-"lao pdr"
nodes[nodes$name=="gambia",]$name<-"gambia, the"
nodes[nodes$name=="micronesia",]$name<-"micronesia, fed. sts."
nodes[nodes$name=="russia",]$name<-"russian federation"
nodes[nodes$name=="syria",]$name<-"syrian arab republic"
nodes[nodes$name=="venezuela",]$name<-"venezuela, rb"
nodes[nodes$name=="yemen",]$name<-"yemen, rep."
nodes[nodes$name=="usa",]$name<-"united states"
nodes[nodes$name=="iran",]$name<-"iran, islamic rep."
nodes[nodes$name=="slovakia",]$name<-"slovak republic"
nodes<-filter(nodes, name %in% c(filter(net_dat, Year==2015 & !is.na(IMF_cred))$Target,"imf"))
nodes$id<-as.integer(rownames(nodes))
nodes<-nodes[c(4,2,3,1)]
h<-dplyr::rename(filter(net_dat,Year==2015 & !is.na(IMF_cred))[c("Source", "Target", "IMF_cred")], FROM=Source, TO=Target)
u<-nodes[c("name", "lat","lon")]
network_<-get.data.frame(graph.data.frame(h, directed=T, vertices=u), "both")
verts_<-network_$vertices
verts_$lat<-as.numeric(verts_$lat)
verts_$lon<-as.numeric(verts_$lon)
coordinates(verts_)<-~lon+lat
runApp('Mappy_Appy2.R')
View(h)
View(u)
runApp('Mappy_Appy2.R')
runApp('Mappy_Appy2.R')
runApp('Mappy_Appy2.R')
View(filter(u, lat<.5 & lat>(-1.5)))
-11.2>-1.5
View(filter(u, ((lat<.5) & (lat>(-1.5)))))
View(filter(filter(u, lat<0.5)), lat>(-1.5))
View(filter(filter(u, lat<0.5), lat>(-1.5)))
View(filter(u, ((lat<.5) & (-1.5<lat))))
view(subset(u, lat<.5))
View(subset(u, lat<.5))
View(subset(u, lat<.5 & lat>(0-1.5)))
-11>-1.5
u$lat<.5
u$lat<.5 & u$lat>-1.5
u$lat[4]
typeof(u$lat)
runApp('Mappy_Appy2.R')
rm(list=ls())
runApp('Mappy_Appy2.R')
runApp('Mappy_Appy2.R')
runApp('Mappy_Appy2.R')
runApp('Mappy_Appy2.R')
rawnodes<-read.csv('http://www.kateto.net/wordpress/wp-content/uploads/2015/06/Country_terms_FREQ.csv')
rawedges<-read.csv('http://www.kateto.net/wordpress/wp-content/uploads/2015/06/Country_terms_COOC.csv')
imf<-WDI(indicator = "DT.DOD.DIMF.CD", country="all",start=2005, extra=F)
imf<-filter(imf, !country %in% unique(imf$country)[1:49])
imf<-rename(imf, Year=year, name=country, IMF_cred=DT.DOD.DIMF.CD)
worldmap = readOGR(dsn="Nat_world_map", layer="ne_50m_admin_0_countries")
worldmap@data[worldmap@data$NAME=="United States of America",]$NAME<-"United States"
worldmap@data[worldmap@data$NAME=="Congo",]$NAME<-"Rep. of Congo"
worldmap@data[worldmap@data$NAME=="South Korea",]$NAME<-"Korea"
worldmap@data[worldmap@data$NAME=="North Korea",]$NAME<-"Dem. Rep. Korea"
worldmap@data[worldmap@data$NAME=="Czechia",]$NAME<-"Czech Rep."
worldmap@data[worldmap@data$NAME==unique(worldmap@data$NAME)[grep("Ivoi",unique(worldmap@data$NAME))],]$NAME<-"Cote d'Ivoire"
worldmap@data[worldmap@data$NAME=="Cabo Verde",]$NAME<-"Cape Verde"
worldmap@data[worldmap@data$NAME=="Trinidad and Tobago",]$NAME<-"Trinidad & Tobago"
worldmap@data[worldmap@data$NAME=="Eq. Guinea",]$NAME<-"Equatorial Guinea"
worldmap@data[worldmap@data$NAME=="Bosnia and Herz.",]$NAME<-"Bosnia"
worldmap@data[worldmap@data$NAME=="Antigua and Barb.",]$NAME<-"Antigua and Barbuda"
worldmap@data[worldmap@data$NAME=="Solomon Is.",]$NAME<-"Solomon Islands"
worldmap@data[worldmap@data$NAME==unique(worldmap@data$NAME)[grep("Tom",unique(worldmap@data$NAME))],]$NAME<-"Sao Tome"
worldmap@data[worldmap@data$NAME_EN=="People's Republic of China",]$NAME_EN<-"China"
worldmap@data[worldmap@data$NAME_EN=="Ivory Coast",]$NAME_EN<-"Cote d'Ivoire"
worldmap@data[worldmap@data$NAME_EN=="Democratic Republic of the Congo",]$NAME_EN<-"Congo, Dem. Rep."
worldmap@data[worldmap@data$NAME_EN=="Republic of the Congo",]$NAME_EN<-"Congo, Rep."
worldmap@data[worldmap@data$NAME_EN=="Cape Verde",]$NAME_EN<-"Cabo Verde"
worldmap@data[worldmap@data$NAME_EN=="Egypt",]$NAME_EN<-"Egypt, Arab Rep."
worldmap@data[worldmap@data$NAME_EN=="Iran",]$NAME_EN<-"Iran, Islamic Rep."
worldmap@data[worldmap@data$NAME_EN=="Federated States of Micronesia",]$NAME_EN<-"Micronesia, Fed. Sts."
worldmap@data[worldmap@data$NAME_EN=="The Gambia",]$NAME_EN<-"Gambia, The"
worldmap@data[worldmap@data$NAME_EN=="Kyrgyzstan",]$NAME_EN<-"Kyrgyz Republic"
worldmap@data[worldmap@data$NAME_EN=="Saint Kitts and Nevis",]$NAME_EN<-"St. Kitts and Nevis"
worldmap@data[worldmap@data$NAME_EN=="Laos",]$NAME_EN<-"Lao PDR"
worldmap@data[worldmap@data$NAME_EN=="Russia",]$NAME_EN<-"Russian Federation"
worldmap@data[worldmap@data$NAME_EN=="Venezuela",]$NAME_EN<-"Venezuela, RB"
worldmap@data[worldmap@data$NAME_EN=="Yemen",]$NAME_EN<-"Yemen, Rep."
worldmap@data[worldmap@data$NAME_EN=="Saint Lucia",]$NAME_EN<-"St. Lucia"
worldmap@data[worldmap@data$NAME_EN==unique(worldmap@data$NAME_EN)[grep("Tom", unique(worldmap@data$NAME_EN))],]$NAME_EN<-"Sao Tome and Principe"
worldmap@data[worldmap@data$NAME_EN=="East Timor",]$NAME_EN<-"Timor-Leste"
worldmap@data[worldmap@data$NAME_EN=="Syria",]$NAME_EN<-"Syrian Arab Republic"
worldmap@data[worldmap@data$NAME_EN=="The Bahamas",]$NAME_EN<-"Bahamas, The"
worldmap@data[worldmap@data$NAME_EN=="Hong Kong",]$NAME_EN<-"Hong Kong SAR, China"
worldmap@data[worldmap@data$NAME_EN=="North Korea",]$NAME_EN<-"Korea, Dem. People's Rep."
worldmap@data[worldmap@data$NAME_EN=="South Korea",]$NAME_EN<-"Korea, Rep."
worldmap@data[worldmap@data$NAME_EN=="Saint Vincent and the Grenadines",]$NAME_EN<-"St. Vincent and the Grenadines"
worldmap@data[worldmap@data$NAME_EN=="United States of America",]$NAME_EN<-"United States"
worldmap@data[worldmap@data$NAME_EN=="Sint Maarten",]$NAME_EN<-"Sint Maarten (Dutch Part)"
worldmap@data[worldmap@data$NAME_EN=="Saint Martin",]$NAME_EN<-"Saint Martin (French Part)"
worldmap@data[worldmap@data$NAME_EN=="Slovakia",]$NAME_EN<-"Slovak Republic"
worldmap@data[worldmap@data$NAME_EN=="United States Virgin Islands",]$NAME_EN<-"Virgin Islands (U.S.)"
View(imf)
worldmap@data[worldmap@data$NAME_EN=="Brunei",]$NAME_EN<-"Brunei Darussalam"
worldmap@data[worldmap@data$NAME_EN==unique(worldmap@data$NAME_EN)[grep("Cura",worldmap@data$NAME_EN)],]$NAME_EN<-"Curacao"
net_dat<-filter(imf, Year==min(imf$Year))[!duplicated(filter(imf, Year==min(imf$Year))$name), c("name","Year","IMF_cred")]
for(o in unique(imf$Year)[-1]){
net_dat<-rbind(net_dat, filter(imf, Year==o)[!duplicated(filter(imf, Year==o)$name), c("name", "Year", "IMF_cred")])
}
net_dat["Source"]<-rep("imf",nrow(net_dat))
net_dat<-net_dat[c(4,1,2,3)]
colnames(net_dat)[2]<-"Target"
nodes<-rename(rawnodes[c("ID","lon","lat")],name=ID)
net_dat$Target<-stringr::str_to_lower(net_dat$Target)
nodes<-rbind(nodes, c("imf", round(-77.04425201622206,6), round(38.89908346600995,6)))
nodes<-rbind(nodes, c("american samoa", round(-170.5794322853497,6), round(-14.26012915103479,6)))
nodes<-rbind(nodes, c("comoros", round(43.48504853332502,6),round(-11.862176383838756,6)))
nodes<-rbind(nodes,c("congo, rep.", round(16.052629791985225,6), round(-0.07691295959726356,6)))
nodes<-rbind(nodes,c("congo, dem. rep.", round(23.84214068136281,6), round(-3.2141630381290125,6)))
nodes<-rbind(nodes,c("cote d'ivoire", round(-5.529500409752393,6),round(7.253827157140813,6)))
nodes<-rbind(nodes,c("eswatini", round(31.526906430335316,6), round(-26.50532674658614, 6)))
nodes<-rbind(nodes,c("guinea-bissau", round(-15.11433094944025,6),round(11.849168222767416,6)))
nodes<-rbind(nodes, c("sao tome and principe", round(6.637044051405797,6), round(0.3877357338129725, 6)))
nodes<-rbind(nodes, c("st. lucia", round(-60.981555430152405,6), round(13.890030848573293,6)))
nodes<-rbind(nodes, c("st. vincent and the grenadines", round(-61.25999737205744,6), round(12.990774451382883,6)))
nodes<-rbind(nodes, c("timor-leste", round(126.04154797375384,6), round(-8.779762146492265,6)))
nodes[nodes$name=="uk",]$name<-"united kingdom"
nodes[nodes$name=="uae",]$name<-"united arab emirates"
nodes[nodes$name=="brunei",]$name<-"brunei darussalam"
nodes[nodes$name=="macedonia",]$name<-"north macedonia"
nodes[nodes$name=="burma",]$name<-"myanmar"
nodes[nodes$name=="bahamas",]$name<-"bahamas, the"
nodes[nodes$name=="cape verde",]$name<-"cabo verde"
nodes[nodes$name=="egypt",]$name<-"egypt, arab rep."
nodes[nodes$name=="hong kong",]$name<-"hong kong sar, china"
nodes[nodes$name=="north korea",]$name<-"korea, dem. people's rep."
nodes[nodes$name=="south korea",]$name<-"korea, rep."
nodes[nodes$name=="kyrgyzstan",]$name<-"kyrgyz republic"
nodes[nodes$name=="laos",]$name<-"lao pdr"
nodes[nodes$name=="gambia",]$name<-"gambia, the"
nodes[nodes$name=="micronesia",]$name<-"micronesia, fed. sts."
nodes[nodes$name=="russia",]$name<-"russian federation"
nodes[nodes$name=="syria",]$name<-"syrian arab republic"
nodes[nodes$name=="venezuela",]$name<-"venezuela, rb"
nodes[nodes$name=="yemen",]$name<-"yemen, rep."
nodes[nodes$name=="usa",]$name<-"united states"
nodes[nodes$name=="iran",]$name<-"iran, islamic rep."
nodes[nodes$name=="slovakia",]$name<-"slovak republic"
nodes<-filter(nodes, name %in% c(filter(net_dat, Year==2005 & !is.na(IMF_cred))$Target,"imf"))
nodes$id<-as.integer(rownames(nodes))
nodes<-nodes[c(4,2,3,1)]
h<-dplyr::rename(filter(net_dat,Year==2005 & !is.na(IMF_cred))[c("Source", "Target", "IMF_cred")], FROM=Source, TO=Target)
u<-nodes[c("name", "lat","lon")]
u[u$name=="maldives",]$lat<-(4.222821)
u[u$name=="maldives",]$lon<-73.153334
network_<-get.data.frame(graph.data.frame(h, directed=T, vertices=u), "both")
setdiff(nodes$name, h$TO)
setdiff(h$TO, u$name)
unique(nodes$name)[grep("kitts", unique(nodes$name))]
setdiff(net_dat$Target, nodes$name)
nodes<-rename(rawnodes[c("ID","lon","lat")],name=ID)
net_dat$Target<-stringr::str_to_lower(net_dat$Target)
nodes<-rbind(nodes, c("imf", round(-77.04425201622206,6), round(38.89908346600995,6)))
nodes<-rbind(nodes, c("american samoa", round(-170.5794322853497,6), round(-14.26012915103479,6)))
nodes<-rbind(nodes, c("comoros", round(43.48504853332502,6),round(-11.862176383838756,6)))
nodes<-rbind(nodes,c("congo, rep.", round(16.052629791985225,6), round(-0.07691295959726356,6)))
nodes<-rbind(nodes,c("congo, dem. rep.", round(23.84214068136281,6), round(-3.2141630381290125,6)))
nodes<-rbind(nodes,c("cote d'ivoire", round(-5.529500409752393,6),round(7.253827157140813,6)))
nodes<-rbind(nodes,c("eswatini", round(31.526906430335316,6), round(-26.50532674658614, 6)))
nodes<-rbind(nodes,c("guinea-bissau", round(-15.11433094944025,6),round(11.849168222767416,6)))
nodes<-rbind(nodes, c("sao tome and principe", round(6.637044051405797,6), round(0.3877357338129725, 6)))
nodes<-rbind(nodes, c("st. lucia", round(-60.981555430152405,6), round(13.890030848573293,6)))
nodes<-rbind(nodes, c("st. vincent and the grenadines", round(-61.25999737205744,6), round(12.990774451382883,6)))
nodes<-rbind(nodes, c("timor-leste", round(126.04154797375384,6), round(-8.779762146492265,6)))
nodes<-rbind(nodes, c("st. kitts and nevis", round(-62.65150902029912, 6), round(17.2450959410363,6)))
nodes[nodes$name=="uk",]$name<-"united kingdom"
nodes[nodes$name=="uae",]$name<-"united arab emirates"
nodes[nodes$name=="brunei",]$name<-"brunei darussalam"
nodes[nodes$name=="macedonia",]$name<-"north macedonia"
nodes[nodes$name=="burma",]$name<-"myanmar"
nodes[nodes$name=="bahamas",]$name<-"bahamas, the"
nodes[nodes$name=="cape verde",]$name<-"cabo verde"
nodes[nodes$name=="egypt",]$name<-"egypt, arab rep."
nodes[nodes$name=="hong kong",]$name<-"hong kong sar, china"
nodes[nodes$name=="north korea",]$name<-"korea, dem. people's rep."
nodes[nodes$name=="south korea",]$name<-"korea, rep."
nodes[nodes$name=="kyrgyzstan",]$name<-"kyrgyz republic"
nodes[nodes$name=="laos",]$name<-"lao pdr"
nodes[nodes$name=="gambia",]$name<-"gambia, the"
nodes[nodes$name=="micronesia",]$name<-"micronesia, fed. sts."
nodes[nodes$name=="russia",]$name<-"russian federation"
nodes[nodes$name=="syria",]$name<-"syrian arab republic"
nodes[nodes$name=="venezuela",]$name<-"venezuela, rb"
nodes[nodes$name=="yemen",]$name<-"yemen, rep."
nodes[nodes$name=="usa",]$name<-"united states"
nodes[nodes$name=="iran",]$name<-"iran, islamic rep."
nodes[nodes$name=="slovakia",]$name<-"slovak republic"
setdiff(net_dat$Target, nodes$name)
unique(imf$name)[grep("muda", unique(imf$name))]
sum(!is.na(filter(imf, name=="Bermuda")$IMF_cred))
unique(imf$name)[grep("irgin", unique(imf$name))]
sum(!is.na(filter(imf, name=="British Virgin Islands")$IMF_cred))
sum(!is.na(filter(imf, name=="Virgin Islands (U.S.)")$IMF_cred))
unique(imf$name)[grep("ayman", unique(imf$name))]
sum(!is.na(filter(imf, name=="Cayman Islands")$IMF_cred))
setdiff(net_dat$Target, nodes$name)
unique(imf$name)[grep("hannel", unique(imf$name))]
sum(!is.na(filter(imf, name=="Channel Islands")$IMF_cred))
sum(!is.na(filter(imf, name=="Faroe Islands")$IMF_cred))
unique(imf$name)[grep("uam", unique(imf$name))]
sum(!is.na(filter(imf, name=="Guam")$IMF_cred))
setdiff(net_dat$Target, nodes$name)
unique(imf$name)[grep("ibral", unique(imf$name))]
sum(!is.na(filter(imf, name=="Gibralter")$IMF_cred))
sum(!is.na(filter(imf, name=="Greenland")$IMF_cred))
sum(!is.na(filter(imf, name=="Macao")$IMF_cred))
unique(imf$name)[grep("urks", unique(imf$name))]
sum(!is.na(filter(imf, name=="Turks and Caicos Islands")$IMF_cred))
runApp('Mappy_Appy2.R')
?checkboxInput
?radioButtons
runApp('Mappy_Appy2.R')
runApp('Mappy_Appy2.R')
runApp('Mappy_Appy2.R')
runApp('Mappy_Appy2.R')
runApp('Mappy_Appy2.R')
runApp('Mappy_Appy2.R')
runApp('Mappy_Appy2.R')
runApp('Mappy_Appy2.R')
runApp('Mappy_Appy2.R')
runApp('Mappy_Appy2.R')
runApp('Mappy_Appy2.R')
runApp('Mappy_Appy2.R')
runApp('Mappy_Appy2.R')
runApp('Mappy_Appy2.R')
